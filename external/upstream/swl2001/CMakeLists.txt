
include(ExternalProject)

get_property(EP_BASE DIRECTORY PROPERTY EP_BASE)
get_property(STAGED_INSTALL_PREFIX DIRECTORY PROPERTY STAGED_INSTALL_PREFIX)
get_property(RADIO_TARGET GLOBAL PROPERTY RADIO_TARGET)
get_property(RADIO_REGION GLOBAL PROPERTY RADIO_REGION)

ExternalProject_Add(
    pico_lora_basic_modem_lib
    GIT_REPOSITORY https://github.com/Lora-net/SWL2001.git
    GIT_TAG v4.5.0
    INSTALL_DIR ${STAGED_INSTALL_PREFIX}
    -DCMAKE_CXX_STANDARD=${CMAKE_CXX_STANDARD}
    CONFIGURE_COMMAND ""
    BUILD_COMMAND cd ${EP_BASE}/Source/pico_lora_basic_modem_lib/lbm_lib && make VERBOSE=no basic_modem_${RADIO_TARGET} MCU_FLAGS=${CMAKE_C_FLAGS} REGION=${RADIO_REGION} MODEM_TRACE=no MODEM_DEEP_TRACE=no CC=${CMAKE_C_COMPILER} #EXTRAFLAGS="-DBSP_CRYSTAL_ERROR=0"
    INSTALL_COMMAND "" 
    UPDATE_COMMAND ""
    BUILD_ALWAYS
    1    
)
